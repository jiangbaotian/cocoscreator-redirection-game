{"version":3,"sources":["commonHandler.js"],"names":["commonHandler","isSound","maxScore","getScale","screenSize","cc","sys","windowPixelResolution","width","height","setSoundStatus","status","localStorage","setItem","getSoundStatus","getMaxScore","setMaxScore","score","submitScore","setInitValue","str1","getItem","parseInt","shareAppMessage","title","shareImg","window","wx","undefined","console","log","imageUrl","query","postMessage","messageType","rankList","groupRankList","success","res","shareTickets","length","shareTicket","module","exports"],"mappings":"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","file":"commonHandler.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["\r\nvar commonHandler = {\r\n    isSound: true,\r\n    maxScore:0,\r\n\r\n    getScale(){\r\n        var screenSize = cc.sys.windowPixelResolution;\r\n        return screenSize.width / screenSize.height / 0.5633;\r\n    },\r\n\r\n    setSoundStatus(status) {\r\n        if (status) {\r\n            cc.sys.localStorage.setItem('isSound', 'on');\r\n        } else {\r\n            cc.sys.localStorage.setItem('isSound', 'off');\r\n        }\r\n        this.isSound = status;\r\n    },\r\n    getSoundStatus() {\r\n        // return false;\r\n        return this.isSound;\r\n    },    \r\n    getMaxScore() {\r\n        return this.maxScore;\r\n    },\r\n\r\n    setMaxScore(score) {\r\n        this.maxScore = score;\r\n        cc.sys.localStorage.setItem('watermaxScore', score);\r\n        this.submitScore(score);\r\n    },\r\n    setInitValue() {\r\n        let str1 = cc.sys.localStorage.getItem('isSound');\r\n        if (str1 == 'on') {\r\n            this.isSound = true;\r\n        } else if (str1 == 'off') {\r\n            this.isSound = false;\r\n        }\r\n        this.maxScore = parseInt(cc.sys.localStorage.getItem('watermaxScore'));\r\n    },\r\n\r\n    shareAppMessage(title, shareImg) {\r\n        if (window.wx != undefined) {\r\n            console.log('share function');\r\n            window.wx.shareAppMessage({title: title, imageUrl: 'res/raw-assets/resources/images/' + shareImg, query: \"from=group\"});\r\n        }\r\n    },\r\n    submitScore(score){\r\n        if (window.wx != undefined) {\r\n            window.wx.postMessage({\r\n                messageType: \"sendScore\",\r\n                score: score,\r\n            });\r\n        } else {\r\n            cc.log(\"fail: x_total : \" + score)\r\n        }\r\n    },\r\n    rankList() {\r\n        if (window.wx != undefined) {\r\n            window.wx.postMessage({\r\n                messageType: \"rankList\",\r\n            });\r\n        } else {\r\n            cc.log(\"fail rank list:\");\r\n        }\r\n    },\r\n\r\n    groupRankList() {\r\n        if (window.wx != undefined) {                \r\n            window.wx.shareAppMessage({\r\n                success: (res) => {\r\n                    if (res.shareTickets != undefined && res.shareTickets.length > 0) {\r\n                        console.log(res.shareTicket);\r\n                        window.wx.postMessage({\r\n                            messageType: 'groupList',\r\n                            shareTicket: res.shareTickets[0]\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // playSound:function(name) {\r\n    //     if (this.isSound) {\r\n    //         if (window.wx != undefined) {\r\n    //             // name = 'crash';\r\n    //             let audio = wx.createInnerAudioContext();\r\n    //             audio.src = \"res/raw-assets/resources/sounds/\" + name + \".mp3\"\r\n    //             audio.play()\r\n    //         }\r\n    //     }\r\n    // },\r\n};\r\nmodule.exports = commonHandler;"]}